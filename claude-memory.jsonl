{"type":"entity","name":"SmartTabsPlugin","entityType":"Project","observations":["Obsidian 플러그인: Smart Tabs (VS Code Style)","GitHub: devmigi/obsidian-ide-preview","싱글클릭=Preview(임시)탭, 더블클릭/편집=Permanent(영구)탭","패널별 독립 관리, 패널당 Preview 최대 1개","해결된 버그: #1 더블클릭→탭닫기→싱글클릭, #2 Daily Notes, #3 (N/A), #4 Ctrl+Click","설정 시스템 없음 (3단계에서 제거)","메인 파일: main.ts (~1000줄, Task B 코드품질 리팩토링 후)","Task B 적용: CONFIG 집중화(VIEW_TYPES/CSS_SELECTORS/GRAPH_DRAG_THRESHOLD), 타입안전성(OpenFileFn/SetViewStateFn/ExplorerView), DRY헬퍼(getExplorerView), 이중언어주석(EN+KR ~15개소)","주석 규칙: 꼭 필요한 곳만, 영문+한글 이중 표기"]}
{"type":"entity","name":"TabStateModel","entityType":"Architecture","observations":["Empty: 빈 탭 (view.getViewType() === 'empty')","Preview: 임시 탭, 이탤릭 표시, 다른 파일 열면 재사용됨, previewLeaves Set으로 관리","Permanent: 일반 탭, 명시적으로 닫기 전까지 유지","상태 판별: getTabState(leaf) → 'empty' | 'preview' | 'permanent'"]}
{"type":"entity","name":"PatchPoints","entityType":"Architecture","observations":["WorkspaceLeaf.openFile: 파일 열기 시 Preview/Permanent 결정","WorkspaceLeaf.setViewState: 비파일 뷰(Graph, Canvas 등) 처리","WorkspaceLeaf.detach: 탭 닫힘 시 정리","위치 판별: leaf.getRoot() === workspace.leftSplit/rightSplit → sidebar, 아니면 main","WorkspaceLeaf.setPinned: 탭 고정 시 Preview→Permanent 승격","vault.create: 새 파일 생성 감지 (newlyCreatedFiles Set)"]}
{"type":"entity","name":"IntentDetection","entityType":"Architecture","observations":["OpenIntent: 'browse' | 'create'","openState?.eState?.rename === 'all' → create (새 노트 생성)","isDailyNote(file) → create","그 외 → browse","주의: openState.eState는 originalMethod.call() 후 mutate됨, 필요한 값은 호출 전에 저장해야 함"]}
{"type":"entity","name":"SidebarDOMStructure","entityType":"TechnicalDetail","observations":["file-explorer: data-path 속성 있음, activeDom + tree.activeDom (별개 객체!)","bookmarks: data-path 없음, itemDoms 사용, .tree-item-self.bookmark 클래스","공통 클래스: is-active(활성, 회색배경), has-focus(포커스, 진회색테두리), is-selected(다중선택)","공통 구조: view.tree { activeDom, focusedItem, selectedDoms(Set) }","explorerView.activeDom과 tree.activeDom은 별개 객체, onFileOpen이 둘을 동기화"]}
{"type":"entity","name":"CriticalBugPatterns","entityType":"Lesson","observations":["DOM 클래스만 제거해도 내부 상태와 불일치 발생","포커스 해제: tree.setFocusedItem(null) 사용","다중선택 해제: tree.clearSelectedDoms() 사용","원칙: Obsidian 내부 상태를 직접 조작하지 말고 공식 메서드 사용","북마크는 data-path 없음 → [data-path] 셀렉터로 찾을 수 없음","getActiveLeaf() 타이밍 문제 → file-open 이벤트에서 lastActiveLeaf를 미리 저장","제어 불가능한 내부 상태(file-open 이벤트 발생 조건)는 우회하는 것이 견고함","전략: 원인을 고치려 하지 말고 결과를 확인하고 보정하는 패턴이 Obsidian API에서 효과적","onFileOpen(null)은 activeDom이 이미 null이면 tree.activeDom을 변경하지 않음 (조건부 동작)","해결: onFileOpen(null) 후 tree.activeDom = null을 명시적으로 설정하여 확실히 초기화","원칙 수정: '직접 조작 금지' → '공식 메서드 우선, 필요 시 직접 보정'"]}
{"type":"entity","name":"SidebarSelectionStrategy","entityType":"TechnicalDetail","observations":["잘못된 방식: document.querySelectorAll('.is-active[data-path]') → 북마크 못 찾음","올바른 방식: sidebar 영역 내 .tree-item-self.is-active, .tree-item-self.has-focus 선택","선택 해제 정석: explorerView.onFileOpen(null) → activeDom, tree.activeDom, is-active 모두 정리"]}
{"type":"entity","name":"StandardBrowseBehavior","entityType":"Spec","observations":["적용 대상: 파일탐색기 싱글클릭, Quick Switcher, 북마크, 검색결과, 그래프뷰, 위키링크, Backlinks, Outgoing Links, 최근파일, Canvas/PDF","Empty탭 → Preview로 열기","Permanent탭 → 기존 Preview 재사용, 없으면 새 Preview 생성","Preview탭 → 해당 탭에서 Preview로 교체","중복 열기 방지: 같은 패널 내 이미 열린 파일은 포커스 이동"]}
{"type":"entity","name":"DoubleClickBehavior","entityType":"Spec","observations":["Empty → Permanent로 열기","Permanent → 보존 → 새 Permanent 탭 생성","Preview(다른파일) → 해당 탭에서 Permanent로 교체","Preview(같은파일) → Permanent로 승격","적용 위치: 파일탐색기, 북마크, 검색결과, 탭헤더"]}
{"type":"entity","name":"PromotionTriggers","entityType":"Spec","observations":["본문 편집: 에디터에서 첫 글자 입력 시","인라인 제목 편집: 300ms debounce","파일 이름 변경: vault rename 이벤트","Canvas 편집: 노드 추가/수정/삭제, 연결선 변경","탭 헤더 더블 클릭","사이드바 더블 클릭 (파일탐색기, 북마크, 검색결과)","PDF는 읽기 전용 → 승격 트리거 없음"]}
{"type":"entity","name":"ExplorerStateBug","entityType":"Bug","observations":["2026-02-10: 더블클릭→탭닫기→싱글클릭 문제 최종 해결","ensureExplorerActiveState(file): originalMethod.call() 후 activeDom 불일치 시 onFileOpen(file) 강제 호출","핵심 발견: file-open 이벤트 미발생이 근본 원인 (탐색기 상태 아님)","detach 후 Obsidian 워크스페이스 레벨 상태가 file-open 이벤트 발생을 차단","2026-02-10 최종 해결: ensureExplorerActiveState() — handleOpenFile에서 파일 연 후 activeDom 불일치 시 보정","해결 전략: detach 시 정리(Phase1+Phase2) + handleOpenFile에서 보정(ensureExplorerActiveState) 병행"]}
{"type":"entity","name":"DocumentStructure","entityType":"ProjectOrganization","observations":["현재 문서: SPEC_KOR.md, SPEC_ENG.md, NOTES_KOR.md, NOTES_ENG.md, TEST_CHECKLIST.txt, README.md","CLAUDE.md: 문서구조 섹션이 _KOR/_ENG 분리 반영 완료"]}
{"type":"entity","name":"ImplementationProgress","entityType":"Status","observations":["2026-02-11: 모든 작업 완료 상태 (1~4단계 + Task A/B/C)","다음 작업 없음 — 최종 릴리스 준비 완료"]}
{"type":"entity","name":"TestingConstraints","entityType":"TestingKnowledge","observations":["링크 테스트는 Empty 탭에서 불가능: 위키링크, Backlinks, Outgoing Links는 노트가 열려있어야 사용 가능","Empty 탭: 빈 상태이므로 노트 본문이나 사이드바 패널이 없음","링크 테스트 가능 상태: Permanent 탭, Preview 탭만 가능","TEST_CHECKLIST.txt 링크 섹션: Empty 탭 3개 항목은 N/A(테스트 불가)로 표시","최근 파일(Recent Files)은 Obsidian 기본 기능 아님: 별도 플러그인(Recent Files Plugin) 필요","무작위 노트(Open random note)는 코어 플러그인: 기본 제공되므로 테스트 가능","TEST_CHECKLIST.txt: 최근 파일 3개 항목 제거, 무작위 노트 3개만 유지","실제 1단계 테스트 항목 수: 93개 (setPinned 포함, 기존 89개는 부정확)","setPinned(탭 고정) → Preview 승격 테스트 항목 추가 (2026-02-11)"]}
{"type":"entity","name":"MemoryConfig","entityType":"Config","observations":["크로스PC 작업을 위해 프로젝트 루트의 claude-memory.jsonl 사용 (MCP memory server)","git으로 동기화되므로 다른 PC에서도 작업 이어가기 가능","Auto Memory (.claude/projects/.../memory/)는 로컬 전용 — git 동기화 안 됨","중요 정보는 반드시 MCP memory(claude-memory.jsonl)에 저장할 것"]}
{"type":"relation","from":"SmartTabsPlugin","to":"TabStateModel","relationType":"uses"}
{"type":"relation","from":"SmartTabsPlugin","to":"PatchPoints","relationType":"implements_via"}
{"type":"relation","from":"PatchPoints","to":"IntentDetection","relationType":"uses"}
{"type":"relation","from":"SmartTabsPlugin","to":"StandardBrowseBehavior","relationType":"follows"}
{"type":"relation","from":"SmartTabsPlugin","to":"DoubleClickBehavior","relationType":"follows"}
{"type":"relation","from":"SmartTabsPlugin","to":"PromotionTriggers","relationType":"follows"}
{"type":"relation","from":"CriticalBugPatterns","to":"SidebarDOMStructure","relationType":"relates_to"}
{"type":"relation","from":"CriticalBugPatterns","to":"SidebarSelectionStrategy","relationType":"informs"}
{"type":"relation","from":"SmartTabsPlugin","to":"ExplorerStateBug","relationType":"fixing"}
{"type":"relation","from":"SmartTabsPlugin","to":"DocumentStructure","relationType":"documented_by"}
{"type":"relation","from":"SmartTabsPlugin","to":"ImplementationProgress","relationType":"tracks"}
{"type":"relation","from":"SmartTabsPlugin","to":"TestingConstraints","relationType":"constrained_by"}
{"type":"relation","from":"TestingConstraints","to":"ImplementationProgress","relationType":"affects"}