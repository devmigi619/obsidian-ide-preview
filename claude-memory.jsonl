{"type":"entity","name":"SmartTabsPlugin","entityType":"Project","observations":["Obsidian 플러그인: Smart Tabs (VS Code Style)","GitHub: devmigi/obsidian-ide-preview","싱글클릭=Preview(임시)탭, 더블클릭/편집=Permanent(영구)탭","패널별 독립 관리, 패널당 Preview 최대 1개","메인 파일: main.js"]}
{"type":"entity","name":"TabStateModel","entityType":"Architecture","observations":["Empty: 빈 탭 (view.getViewType() === 'empty')","Preview: 임시 탭, 이탤릭 표시, 다른 파일 열면 재사용됨, previewLeaves Set으로 관리","Permanent: 일반 탭, 명시적으로 닫기 전까지 유지","상태 판별: getTabState(leaf) → 'empty' | 'preview' | 'permanent'"]}
{"type":"entity","name":"PatchPoints","entityType":"Architecture","observations":["WorkspaceLeaf.openFile: 파일 열기 시 Preview/Permanent 결정","WorkspaceLeaf.setViewState: 비파일 뷰(Graph, Canvas 등) 처리","WorkspaceLeaf.detach: 탭 닫힘 시 정리","위치 판별: leaf.getRoot() === workspace.leftSplit/rightSplit → sidebar, 아니면 main"]}
{"type":"entity","name":"IntentDetection","entityType":"Architecture","observations":["OpenIntent: 'browse' | 'create'","openState?.eState?.rename === 'all' → create (새 노트 생성)","isDailyNote(file) → create","그 외 → browse","주의: openState.eState는 originalMethod.call() 후 mutate됨, 필요한 값은 호출 전에 저장해야 함"]}
{"type":"entity","name":"SidebarDOMStructure","entityType":"TechnicalDetail","observations":["file-explorer: data-path 속성 있음, activeDom + tree.activeDom (별개 객체!)","bookmarks: data-path 없음, itemDoms 사용, .tree-item-self.bookmark 클래스","공통 클래스: is-active(활성, 회색배경), has-focus(포커스, 진회색테두리), is-selected(다중선택)","공통 구조: view.tree { activeDom, focusedItem, selectedDoms(Set) }","explorerView.activeDom과 tree.activeDom은 별개 객체, onFileOpen이 둘을 동기화"]}
{"type":"entity","name":"CriticalBugPatterns","entityType":"Lesson","observations":["activeDom 직접 null 설정 금지 → explorerView.onFileOpen(null) 사용해야 함","explorerView.activeDom만 null로 하면 tree.activeDom과 불일치 → file-open 이벤트 미발생","DOM 클래스만 제거해도 내부 상태와 불일치 발생","포커스 해제: tree.setFocusedItem(null) 사용","다중선택 해제: tree.clearSelectedDoms() 사용","원칙: Obsidian 내부 상태를 직접 조작하지 말고 공식 메서드 사용","북마크는 data-path 없음 → [data-path] 셀렉터로 찾을 수 없음","getActiveLeaf() 타이밍 문제 → file-open 이벤트에서 lastActiveLeaf를 미리 저장"]}
{"type":"entity","name":"SidebarSelectionStrategy","entityType":"TechnicalDetail","observations":["잘못된 방식: document.querySelectorAll('.is-active[data-path]') → 북마크 못 찾음","올바른 방식: sidebar 영역 내 .tree-item-self.is-active, .tree-item-self.has-focus 선택","선택 해제 정석: explorerView.onFileOpen(null) → activeDom, tree.activeDom, is-active 모두 정리"]}
{"type":"entity","name":"StandardBrowseBehavior","entityType":"Spec","observations":["적용 대상: 파일탐색기 싱글클릭, Quick Switcher, 북마크, 검색결과, 그래프뷰, 위키링크, Backlinks, Outgoing Links, 최근파일, Canvas/PDF","Empty탭 → Preview로 열기","Permanent탭 → 기존 Preview 재사용, 없으면 새 Preview 생성","Preview탭 → 해당 탭에서 Preview로 교체","중복 열기 방지: 같은 패널 내 이미 열린 파일은 포커스 이동"]}
{"type":"entity","name":"DoubleClickBehavior","entityType":"Spec","observations":["Empty → Permanent로 열기","Permanent → 보존 → 새 Permanent 탭 생성","Preview(다른파일) → 해당 탭에서 Permanent로 교체","Preview(같은파일) → Permanent로 승격","적용 위치: 파일탐색기, 북마크, 검색결과, 탭헤더"]}
{"type":"entity","name":"PromotionTriggers","entityType":"Spec","observations":["본문 편집: 에디터에서 첫 글자 입력 시","인라인 제목 편집: 300ms debounce","파일 이름 변경: vault rename 이벤트","Canvas 편집: 노드 추가/수정/삭제, 연결선 변경","탭 헤더 더블 클릭","사이드바 더블 클릭 (파일탐색기, 북마크, 검색결과)","PDF는 읽기 전용 → 승격 트리거 없음"]}
{"type":"entity","name":"UnimplementedFeatures","entityType":"Status","observations":["파일탐색기/북마크/검색 더블클릭 → Permanent (미완)","최근 파일 / 무작위 노트 동작 (미테스트)","Canvas 편집 승격 (미테스트)","PDF 열기 (미테스트)","향후: 리본 버튼 더블클릭, 그래프 뷰 조작 승격, 탭 드래그 승격, 탭 고정(Pin) 승격"]}
{"type":"entity","name":"PluginSettings","entityType":"Feature","observations":["Italic title for preview: Preview 탭 이탤릭 표시","Reuse empty tab: 빈 탭 재사용","Promote old preview: 같은 패널 내 이전 Preview 보존(Permanent로)","Focus existing tab: 같은 패널 내 중복 방지","Open new tab at end: 탭바 끝에 새 탭 생성"]}
{"type":"entity","name":"ExplorerStateBug","entityType":"Bug","observations":["[현상] 옵시디언 기본 동작 버그 (플러그인 무관하게 발생)","[재현 절차] 1) 탐색기에서 파일을 더블클릭으로 열기 → is-active(회색블록) + has-focus(진회색보더) 동시 발생","[재현 절차] 2) 아무 동작 없이(다른 곳 클릭, 편집 등 없이) 바로 탭을 닫기","[재현 절차] 3) 탐색기에 is-active와 has-focus가 잔류함 (소실되지 않음)","[재현 절차] 4) 이 상태에서 해당 파일을 싱글클릭하든 더블클릭하든 아무 반응 없음 (이미 활성으로 인식)","[임시 해결] 다른 곳을 한번 클릭해서 활성 해제하면 다시 정상 동작","[목표] 플러그인에서 탭 닫힘 시 이 잔류 상태를 정리해주려고 함"]}
{"type":"entity","name":"ExplorerStateBug_FixAttempt","entityType":"DebugProgress","observations":["[시도] is-active와 has-focus 제거에 성공함","[부분 성공] 제거 후 클릭이 다시 먹힘 → 일견 해결된 것처럼 보임","[2차 문제 발견] 더블클릭 → 탭 닫기 → 같은 파일 싱글클릭 시: 파일은 열리지만 탐색기에 is-active(회색블록)가 안 생김","[2차 문제 원인 추정] 탭 닫을 때 상태 정리 과정에서 Obsidian 내부 상태가 꼬여서, 이후 파일을 열어도 탐색기가 is-active를 다시 씌워주지 못함","[핵심 질문] 상태 제거를 explorerView.onFileOpen(null)로 했는지, DOM 클래스 직접 제거나 activeDom 직접 null 설정으로 했는지 → 사용자 확인: 후자(직접 제거) 방식을 사용함","[다음 단계] explorerView.onFileOpen(null) 등 공식 메서드를 사용하여 내부 상태 정합성을 유지하면서 정리하는 방식으로 전환 필요"]}
{"type":"relation","from":"SmartTabsPlugin","to":"TabStateModel","relationType":"uses"}
{"type":"relation","from":"SmartTabsPlugin","to":"PatchPoints","relationType":"implements_via"}
{"type":"relation","from":"SmartTabsPlugin","to":"PluginSettings","relationType":"has"}
{"type":"relation","from":"PatchPoints","to":"IntentDetection","relationType":"uses"}
{"type":"relation","from":"SmartTabsPlugin","to":"StandardBrowseBehavior","relationType":"follows"}
{"type":"relation","from":"SmartTabsPlugin","to":"DoubleClickBehavior","relationType":"follows"}
{"type":"relation","from":"SmartTabsPlugin","to":"PromotionTriggers","relationType":"follows"}
{"type":"relation","from":"SmartTabsPlugin","to":"UnimplementedFeatures","relationType":"tracks"}
{"type":"relation","from":"CriticalBugPatterns","to":"SidebarDOMStructure","relationType":"relates_to"}
{"type":"relation","from":"CriticalBugPatterns","to":"SidebarSelectionStrategy","relationType":"informs"}
{"type":"relation","from":"ExplorerStateBug","to":"ExplorerStateBug_FixAttempt","relationType":"being_fixed_by"}
{"type":"relation","from":"ExplorerStateBug_FixAttempt","to":"CriticalBugPatterns","relationType":"relates_to"}
{"type":"relation","from":"SmartTabsPlugin","to":"ExplorerStateBug","relationType":"fixing"}